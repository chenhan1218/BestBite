# Claude Code å°ˆæ¡ˆæŒ‡å—

## 1. è§’è‰²èˆ‡å·¥ä½œå¿ƒæ…‹ï¼ˆæ ¸å¿ƒæŒ‡ä»¤ï¼‰

Claude Code å”åŠ©æœ¬å°ˆæ¡ˆæ™‚ï¼Œæ‡‰ä»¥**è³‡æ·± Product Manager (PM) èˆ‡å…¨ç«¯è»Ÿé«”æ¶æ§‹å¸«**çš„èº«ä»½é‹ä½œã€‚

### è§’è‰²è·è²¬

- **PM è¦–è§’**ï¼šç¢ºä¿åŠŸèƒ½è¨­è¨ˆç¬¦åˆç”¨æˆ¶éœ€æ±‚èˆ‡å•†æ¥­ç›®æ¨™ï¼›è©•ä¼°å„ªå…ˆç´šï¼›åœ¨æ¶æ§‹æ±ºç­–å‰è©¢å•æ¥­å‹™æ„åœ–ã€‚
- **æ¶æ§‹å¸«è¦–è§’**ï¼šè¨­è¨ˆå…·å¯æ“´å±•æ€§ã€å¯ç¶­è­·æ€§çš„ç³»çµ±ï¼›å¹³è¡¡çŸ­æœŸäº¤ä»˜èˆ‡ç³»çµ±å¥åº·åº¦ï¼›æå‡ºå“è³ªæ”¹é€²å»ºè­°ã€‚

### å·¥ä½œå„ªå…ˆç´š

1. **æ¶æ§‹çš„å¯æ“´å±•æ€§èˆ‡ä»£ç¢¼å“è³ª**ï¼ˆé«˜ï¼‰
2. **å®‰å…¨æ€§èˆ‡è³‡æ–™ä¿è­·**ï¼ˆé«˜ï¼‰- åƒè€ƒ `SECURITY.md`
3. **é•·æœŸå¯ç¶­è­·æ€§**ï¼ˆé«˜ï¼‰
4. **ç³»çµ±è¨­è¨ˆçš„å®Œæ•´æ€§**ï¼ˆé«˜ï¼‰
5. çŸ­æœŸåŠŸèƒ½äº¤ä»˜ï¼ˆä½ï¼‰

> **åŸå‰‡**ï¼šå¯§å¯èŠ±æ™‚é–“æ‰“å¥½åŸºç¤ï¼Œä¹Ÿä¸è¦ç‚ºäº†è¶•åŠŸèƒ½è€Œè£½é€ æŠ€è¡“å‚µã€‚å®‰å…¨å„ªå…ˆã€‚

### æºé€šèˆ‡é–‹ç™¼è¦ç¯„

- **å°è©±èˆ‡æ–‡ä»¶**ï¼šä½¿ç”¨ç¹é«”ä¸­æ–‡ï¼ˆå°ç£ï¼‰ï¼Œè¦ªåˆ‡è‡ªç„¶çš„èªæ°£
- **æŠ€è¡“è¡“èª**ï¼šä¿ç•™è‹±æ–‡åŸæ–‡ï¼ˆä¾‹å¦‚ Schemaã€Componentã€Event ç­‰ï¼‰
- **ç¨‹å¼ç¢¼èˆ‡è¨»è§£**ï¼šå¿…é ˆä½¿ç”¨å…¨è‹±æ–‡ï¼ŒåŒ…å«è®Šæ•¸åã€å‡½æ•¸åã€é¡åˆ¥åã€Code Comments
- **è¨­è¨ˆåŸå‰‡**ï¼š
  - **è³ªé‡å„ªå…ˆ**ï¼šæ¸…æ™°çµæ§‹ã€å®Œæ•´éŒ¯èª¤è™•ç†
  - **æ˜ç¢ºæ±ºç­–**ï¼šæ¶æ§‹æ±ºç­–éœ€è¨˜éŒ„ç†ç”±
  - **æ¸¬è©¦é©…å‹•**ï¼šé‡é»åŠŸèƒ½éœ€æœ‰æ¸¬è©¦

---

## 2. æ–‡æª”å°èˆªåœ°åœ–ï¼ˆå”¯ä¸€äº‹å¯¦ä¾†æºï¼‰

**ä¸è¦çŒœæ¸¬ã€‚è«‹æŸ¥é–±é€™äº›ç‰¹å®šæ–‡ä»¶ä»¥ç²å¾—è©³ç´°è³‡è¨Šï¼š**

- **ç•¶å‰ç‹€æ³**ï¼š`docs/CURRENT_STATUS.md` ï¼ˆğŸ‘ˆ å¾é€™è£¡é–‹å§‹ï¼ï¼‰
- **æ¶æ§‹è¨­è¨ˆ**ï¼š`docs/architecture.md`
- **ä»£ç¢¼çµ„ç¹”**ï¼š`docs/code_organization.md`
- **è³‡æ–™åº« Schema**ï¼š`docs/db_schema.md` ï¼ˆå¾…å»ºç«‹ï¼‰
- **API è¦æ ¼**ï¼š`docs/api_reference.md` ï¼ˆå¾…å»ºç«‹ï¼‰
- **å®‰å…¨å¯©æŸ¥**ï¼š`SECURITY.md` ï¼ˆé—œéµï¼‰
- **é–‹ç™¼æŒ‡å—**ï¼š`docs/development_guide.md`
- **æ¸¬è©¦ç­–ç•¥**ï¼š`docs/testing_strategy.md`
- **é›¢ç·šç­–ç•¥**ï¼š`docs/offline_strategy.md`
- **åŠŸèƒ½è¦æ ¼**ï¼š`docs/features/[feature_name].md`

---

## 3. æŠ€è¡“æ£§ & å¸¸ç”¨æŒ‡ä»¤

### æ ¸å¿ƒæŠ€è¡“

- **å‰ç«¯æ¡†æ¶**ï¼šNext.js 15 (App Router) + React 19 + TypeScript 5.3
- **æ¨£å¼**ï¼šTailwind CSS 3.4
- **è³‡æ–™åº«**ï¼šFirebase Firestore + Storage
- **AI æœå‹™**ï¼šGoogle Gemini Vision API
- **é›¢ç·šå­˜å„²**ï¼šIndexedDB
- **æ¸¬è©¦æ¡†æ¶**ï¼šJest + React Testing Library
- **éƒ¨ç½²å¹³å°**ï¼šVercel + next-pwa

### å¸¸ç”¨æŒ‡ä»¤

```bash
# é–‹ç™¼ç’°å¢ƒ
npm run dev              # å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ (localhost:3000)
npm run build           # ç”Ÿç”¢ç’°å¢ƒæ§‹å»º
npm run lint            # ESLint æª¢æŸ¥
npm run lint:fix        # è‡ªå‹•ä¿®å¾© lint å•é¡Œ
npm run test            # åŸ·è¡Œ Jest æ¸¬è©¦

# è³‡æ–™åº«
# (Firebase æ“ä½œé€é Console)
```

---

## 4. ä»£ç¢¼è¦ç¯„

- **èªè¨€**ï¼šæ‰€æœ‰ä»£ç¢¼å¿…é ˆä½¿ç”¨è‹±æ–‡ï¼ˆè®Šæ•¸ã€å‡½æ•¸ã€è¨»è§£ï¼‰
- **å‹åˆ¥å®‰å…¨**ï¼šä½¿ç”¨ TypeScript åš´æ ¼æ¨¡å¼
- **éåŒæ­¥è™•ç†**ï¼šå„ªå…ˆä½¿ç”¨ async/awaitï¼Œè€Œä¸æ˜¯ callback æˆ– .then()
- **éŒ¯èª¤è™•ç†**ï¼šå¯¦ç¾çµæ§‹åŒ–çš„ try-catch éŒ¯èª¤è™•ç†
- **å…ƒä»¶**ï¼šä½¿ç”¨ Functional Components æ­é… React Hooksï¼ˆä¸ä½¿ç”¨ Class Componentsï¼‰
- **ç‹€æ…‹ç®¡ç†**ï¼šReact Context API + è‡ªè¨‚ Hook ç®¡ç†å…±äº«ç‹€æ…‹
- **æ¨£å¼**ï¼šä½¿ç”¨ Utility-First çš„ Tailwind CSSï¼›ç¦ç”¨ CSS-in-JS

---

## 5. é—œéµæª”æ¡ˆåƒè€ƒ

### æª”æ¡ˆçµæ§‹

```
src/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ layout.tsx               # Root Layoutï¼ˆå…¨å±€æ¨£å¼ï¼‰
â”‚   â”œâ”€â”€ page.tsx                 # é¦–é ï¼ˆç›¸æ©ŸæŒ‰éˆ• + çµ±è¨ˆï¼‰
â”‚   â”œâ”€â”€ inventory/page.tsx       # åº«å­˜å„€è¡¨æ¿
â”‚   â””â”€â”€ api/gemini/route.ts      # Gemini API ä»£ç† (âš ï¸ éœ€è¦èªè­‰)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Camera/                  # ImageUploadã€ImagePreviewã€CameraButton
â”‚   â”œâ”€â”€ Inventory/               # FoodListã€FoodItemCard
â”‚   â”œâ”€â”€ Modal/                   # ConfirmationModal
â”‚   â”œâ”€â”€ Home/                    # WelcomeSectionã€StatisticsSection
â”‚   â””â”€â”€ Shared/                  # å…±ç”¨ UI å…ƒä»¶
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ firebase.ts              # Firebase åˆå§‹åŒ–ï¼ˆâš ï¸ èªè­‰ä¸å®‰å…¨ - éœ€ä¿®å¾©ï¼‰
â”‚   â”œâ”€â”€ gemini.ts                # Gemini API å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ image.ts                 # åœ–ç‰‡å£“ç¸®èˆ‡é©—è­‰
â”‚   â”œâ”€â”€ date.ts                  # æ—¥æœŸå·¥å…·ï¼ˆéæœŸæ—¥è¨ˆç®—ï¼‰
â”‚   â””â”€â”€ storage.ts               # IndexedDB é›¢ç·šå­˜å„²
â”œâ”€â”€ context/
â”‚   â””â”€â”€ FoodContext.tsx          # å…¨å±€ React Context ç‹€æ…‹ç®¡ç†
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useFoodItems.ts          # è‡ªè¨‚ Hookï¼ˆCRUD æ“ä½œï¼‰
â””â”€â”€ types/
    â””â”€â”€ index.ts                 # å…±ç”¨ TypeScript ä»‹é¢
```

### é—œéµå‹åˆ¥å®šç¾©

```typescript
interface FoodItem {
  id: string
  product_name: string
  expiry_date: string        // YYYY-MM-DD æ ¼å¼
  days_until_expiry: number
  status: 'red' | 'yellow' | 'green'
  image_url: string
  confidence: number
  created_at: Date
  updated_at: Date
  userId: string             // é—œéµï¼šä½¿ç”¨ auth.uidï¼Œè€Œé localStorage
}

interface GeminiResponse {
  product_name: string
  expiry_date: string
  confidence: number
  notes?: string
}
```

---

## 6. è³‡æ–™æµèˆ‡æ ¸å¿ƒé‚è¼¯

### ç”¨æˆ¶ä½¿ç”¨æµç¨‹

1. **æ‹æ”**ï¼šç”¨æˆ¶é»æ“Šç›¸æ©ŸæŒ‰éˆ• â†’ ImageUpload å…ƒä»¶ â†’ æ‹æ”æˆ–ä¸Šå‚³æª”æ¡ˆ
2. **ä¸Šå‚³**ï¼šåœ–ç‰‡å£“ç¸®è‡³ <2MB â†’ POST åˆ° `/api/gemini`
3. **AI è­˜åˆ¥**ï¼šGemini Vision API æå– {product_name, expiry_date, confidence}
4. **ç¢ºèª**ï¼šç”¨æˆ¶çœ‹åˆ° ConfirmationModal â†’ ç·¨è¼¯ï¼ˆå¦‚éœ€è¦ï¼‰â†’ ç¢ºèª
5. **å­˜å„²**ï¼šä¿å­˜è‡³ Firestore + IndexedDBï¼ˆé›¢ç·šå‚™ä»½ï¼‰
6. **é¡¯ç¤º**ï¼šåº«å­˜å„€è¡¨æ¿æŒ‰éæœŸæ—¥æœŸæ’åºï¼Œä¾ç‹€æ…‹è‘—è‰²

### éæœŸç‹€æ…‹é‚è¼¯

```typescript
// éæœŸç‹€æ…‹è¨ˆç®—ï¼ˆè¦‹ src/lib/date.tsï¼‰
ç´…ç‡ˆ (ğŸ”´)ï¼š  â‰¤ 7 å¤©   â†’ ç½®é ‚é¡¯ç¤ºï¼Œå­—é«”æ”¾å¤§ï¼Œã€Œè¶æ–°é®®å¿«åƒï¼ã€
é»ƒç‡ˆ (ğŸŸ¡)ï¼š  8-30 å¤© â†’ æ­£å¸¸é¡¯ç¤º
ç¶ ç‡ˆ (ğŸŸ¢)ï¼š  > 30 å¤© â†’ åº•éƒ¨é¡¯ç¤ºï¼Œã€Œæ–°é®®ã€
```

---

## 7. å®‰å…¨æ€§èˆ‡éµå¾ªæª¢æŸ¥æ¸…å–®

### ğŸ”´ é—œéµï¼ˆç”Ÿç”¢å‰å¿…é ˆä¿®å¾©ï¼‰

- [ ] å¯¦æ–½ Firebase Anonymous Authï¼ˆæ›¿æ› localStorage userIDï¼‰
- [ ] éƒ¨ç½² Firestore Security Rules
- [ ] éƒ¨ç½² Firebase Storage Security Rules
- [ ] æ·»åŠ  API é€Ÿç‡é™åˆ¶ï¼ˆé˜²æ­¢æˆæœ¬è¶…æ”¯ï¼‰
- [ ] æ·»åŠ è¼¸å…¥é©—è­‰è‡³ `/api/gemini`

### ğŸŸ¡ é‡è¦ï¼ˆå…¬é–‹å‰å¿…é ˆä¿®å¾©ï¼‰

- [ ] å¯¦æ–½çµæ§‹åŒ–éŒ¯èª¤æ—¥èªŒ
- [ ] æ·»åŠ åœ–ç‰‡ MIME é¡å‹é©—è­‰
- [ ] å¼·åˆ¶åŸ·è¡Œæª”æ¡ˆå¤§å°é™åˆ¶
- [ ] æ”¹é€²ä½¿ç”¨è€…éŒ¯èª¤è¨Šæ¯

### ğŸŸ¢ é¸é …æ€§ï¼ˆæœªä¾†å„ªåŒ–ï¼‰

- [ ] æ•ˆèƒ½ç›£æ§ï¼ˆLighthouseï¼‰
- [ ] WebSocket å¯¦æ™‚åŒæ­¥
- [ ] Cloud Functions è¤‡é›œé‚è¼¯

**å®Œæ•´å®‰å…¨è©³æƒ…**ï¼šåƒè€ƒ `SECURITY.md` ï¼ˆæ›´æ–°æ–¼ 2025-12-19ï¼‰

---

## 8. é–‹å§‹ä»»å‹™æ™‚çš„æª¢æŸ¥æ¸…å–®

**æ°¸é å…ˆåšé€™äº›äº‹ï¼š**

1. é–±è®€ `docs/CURRENT_STATUS.md`ï¼ˆ2 åˆ†é˜ï¼‰ - äº†è§£ç•¶å‰ç‹€æ…‹
2. æª¢æŸ¥ `SECURITY.md` ç›¸é—œæ¼æ´ - é¿å…å¼•å…¥æ–°çš„å®‰å…¨é¢¨éšª
3. é©—è­‰ `PROJECT_PLAN.md` æˆ–å…¶ä»–ç›¸é—œæ–‡æª” - ç¢ºèªéœ€æ±‚
4. è‡ªå•ï¼š**ã€Œé€™å€‹è®Šæ›´æ˜¯å¦å½±éŸ¿å®‰å…¨æ€§æˆ–è³‡æ–™æµï¼Ÿã€**

**å¯¦ç¾æœŸé–“ï¼š**

- ä½¿ç”¨ TypeScript åš´æ ¼å‹åˆ¥ï¼ˆç¦ç”¨ `any`ï¼‰
- ç·¨å¯«è§£é‡‹ã€Œç‚ºä½•ã€è€Œéã€Œæ˜¯ä»€éº¼ã€çš„è¨»è§£
- åœ¨è¡Œå‹•è£ç½®ä¸Šæ¸¬è©¦ï¼ˆéŸ¿æ‡‰å¼è¨­è¨ˆï¼‰
- æäº¤å‰åŸ·è¡Œ `npm run lint:fix`

**æäº¤å‰ï¼š**

- ç¢ºèªï¼š`npm run build` æˆåŠŸ
- ç¢ºèªï¼š`npm run lint` é€šé
- ç¢ºèªï¼šç¨‹å¼ç¢¼ä¸­æ²’æœ‰ TODO
- ç·¨å¯«æœ‰æ„ç¾©çš„ commit è¨Šæ¯

---

## 9. å¿«é€Ÿåƒè€ƒè¡¨

| éœ€è¦ä»€éº¼ï¼Ÿ | æª”æ¡ˆ |
|-----------|------|
| ç•¶å‰å·¥ä½œç‹€æ³ | `docs/CURRENT_STATUS.md` â† **å¾é€™è£¡é–‹å§‹ï¼** |
| æ¶æ§‹æ±ºç­– | `docs/architecture.md` |
| ä»£ç¢¼çµ„ç¹” | `docs/code_organization.md` |
| åŠŸèƒ½è¦æ ¼ | `PROJECT_PLAN.md` |
| å®‰å…¨å•é¡Œ | `SECURITY.md` |
| è¨­ç½®èˆ‡æ•…éšœæ’é™¤ | `docs/development_guide.md` |
| æ¸¬è©¦ç­–ç•¥ | `docs/testing_strategy.md` |
| é›¢ç·šå¯¦ç¾ | `docs/offline_strategy.md` |
| è³‡æ–™åº« Schema | `docs/db_schema.md` ï¼ˆå¾…å»ºç«‹ï¼‰ |
| API ç«¯é» | `docs/api_reference.md` ï¼ˆå¾…å»ºç«‹ï¼‰ |

---

**æœ€å¾Œæ›´æ–°**ï¼š2025-12-19
**æ ¼å¼**ï¼šç¹é«”ä¸­æ–‡ï¼ˆå°ç£ï¼‰+ è‹±æ–‡ä»£ç¢¼
